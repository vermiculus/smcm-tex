% cd ../.. && make cosc
\RequirePackage{xcolor}
\lstdefinestyle{smcm-std}{
  frame=single,
  frameround=tttt,
  % TODO background color extends past rounded corner
  backgroundcolor=\color{blue!5},
  rulecolor=\color{blue!50!black},
  showstringspaces=false,
  showspaces=false,
  showtabs=false,
}
\renewcommand*\lstlistlistingname{List~of~Listings}
\lstdefinestyle{python}{
  style=smcm-std,
  language=Python,
  morekeywords={assert,self,None,as},
  basicstyle=\small\ttfamily,
  moredelim=*[s][\lst@stringstyle]{"""}{"""},
}

\lstdefinestyle{litpython}{
  style=python,
  moredelim=[s][\lst@commentstyle]{<<}{>>},
  rangeprefix={\#\%\ },
  rangesuffix={\ \%\#},
  includerangemarker=false,
}

\lstdefinestyle{pythonex}{
  style=python,
  morekeywords={@predicate,@move,author,version},
}

% add key 'litkey' that is a shortcut for 'linerange={#1}-{end-#1}'
\lst@Key{litkey}\relax{\lstKV@OptArg[]{{#1}-{end-#1}}{%
    \def\lst@interrange{##1}
    \def\lst@linerange{##2,}}}


\newcommand\YAMLcolonstyle{\color{red}\mdseries}
\newcommand\YAMLkeystyle{\color{black}\bfseries}
\newcommand\YAMLvaluestyle{\color{blue}\mdseries}

\lstdefinelanguage{yaml}{
  keywords={true,false,null,y,n},
  keywordstyle=\color{darkgray}\bfseries,
  basicstyle=\YAMLkeystyle,                                 % assuming a key comes first
  sensitive=false,
  comment=[l]{\#},
  morecomment=[s]{/*}{*/},
  commentstyle=\color{purple}\ttfamily,
  stringstyle=\YAMLvaluestyle\ttfamily,
  showstringspaces=false,
  moredelim=[l][\color{orange}]{\&},
  moredelim=[l][\color{magenta}]{*},
  moredelim=**[il][\YAMLcolonstyle{:}\YAMLvaluestyle]{:},   % switch to value style at :
  morestring=[b]',
  morestring=[b]",
  literate =    {---}{{\ProcessThreeDashes}}3
                {>}{{\textcolor{red}\textgreater}}1
                {|}{{\textcolor{red}\textbar}}1
                {\ -\ }{{\mdseries\ -\ }}3,
}

\newcommand\TimeForYAML{\lst@AddToHook{EOL}{\YAMLkeystyle}}

\newcommand\ProcessThreeDashes{{\color{cyan}\mdseries-{-}-}}
